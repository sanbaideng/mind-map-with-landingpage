# ä¾èµ–å‡çº§æŒ‡å— Dependencies Upgrade Guide

## ğŸ“Š å½“å‰çŠ¶æ€

- **Next.js**: 14.2.20
- **React**: 18.3.1
- **next-intl**: 3.25.3
- **TypeScript**: 5.7.2

## âœ… å·²å®Œæˆçš„æ›´æ–°

### 1. Browserslist æ•°æ®åº“
```bash
npx update-browserslist-db@latest
```

è¿™ä¼šæ›´æ–° `caniuse-lite` æ•°æ®åº“ï¼Œè§£å†³æµè§ˆå™¨å…¼å®¹æ€§æ•°æ®è¿‡æœŸçš„è­¦å‘Šã€‚

## ğŸš€ å…³äºå‡çº§åˆ° Next.js 15

### Next.js 15 çš„ä¸»è¦å˜åŒ–

**æ–°ç‰¹æ€§ï¼š**
- âœ… React 19 æ”¯æŒ
- âœ… æ”¹è¿›çš„ç¼“å­˜ç­–ç•¥
- âœ… Turbopack ç¨³å®šç‰ˆï¼ˆå¼€å‘æ¨¡å¼ï¼‰
- âœ… æ”¹è¿›çš„ Server Actions
- âœ… éƒ¨åˆ†é¢„æ¸²æŸ“ï¼ˆPPRï¼‰

**ç ´åæ€§å˜æ›´ï¼š**
- âš ï¸ `next/image` é»˜è®¤è¡Œä¸ºå˜åŒ–
- âš ï¸ `fetch` ç¼“å­˜é»˜è®¤å€¼å˜æ›´
- âš ï¸ React 19 éœ€è¦æ›´æ–°ç›¸å…³åº“

### æ˜¯å¦åº”è¯¥å‡çº§ï¼Ÿ

**å»ºè®®ï¼šæš‚æ—¶ä¿æŒ Next.js 14** âœ‹

åŸå› ï¼š
1. **next-intl å…¼å®¹æ€§**ï¼šéœ€è¦ç¡®è®¤æ˜¯å¦å®Œå…¨æ”¯æŒ Next.js 15
2. **Headless UI**ï¼šå¯èƒ½éœ€è¦æ›´æ–°åˆ°æ”¯æŒ React 19 çš„ç‰ˆæœ¬
3. **ç”Ÿæ€ç³»ç»Ÿç¨³å®šæ€§**ï¼šç­‰å¾…ç¤¾åŒºåº“å®Œå…¨æ”¯æŒ
4. **ç”Ÿäº§ç¨³å®šæ€§**ï¼šNext.js 14 æ›´ç¨³å®šå¯é 

**å¦‚æœä½ æƒ³å°è¯• Next.js 15ï¼š**
- å»ºè®®ç­‰å¾… 1-2 ä¸ªæœˆ
- è®©ç¤¾åŒºåº“å®Œå…¨æ”¯æŒ
- ç­‰å¾… Next.js 15.x.x ä¿®å¤åˆæœŸ bug

## ğŸ“¦ æ¨èçš„æ›´æ–°ç­–ç•¥

### é˜¶æ®µ 1ï¼šå®‰å…¨æ›´æ–°ï¼ˆç«‹å³æ‰§è¡Œï¼‰

è¿™äº›æ›´æ–°ä¸ä¼šç ´åç°æœ‰ä»£ç ï¼š

```json
{
  "dependencies": {
    "@headlessui/react": "^2.2.0",        // æœ€æ–°
    "@heroicons/react": "^2.2.0",         // æœ€æ–°
    "@tailwindcss/forms": "^0.5.9",       // æœ€æ–°
    "autoprefixer": "^10.4.20",           // æœ€æ–°
    "clsx": "^2.1.1",                     // æœ€æ–°
    "next": "^14.2.20",                   // ä¿æŒ 14
    "next-intl": "^3.25.3",               // æœ€æ–°
    "tailwindcss": "^3.4.16",             // æœ€æ–°
    "typescript": "^5.7.2"                // æœ€æ–°
  },
  "devDependencies": {
    "eslint": "^8.57.1",                  // è€ƒè™‘å‡çº§åˆ° 9.x
    "prettier": "^3.4.2",                 // æœ€æ–°
    "sharp": "^0.33.5"                    // å¯ä»¥æ›´æ–°
  }
}
```

### é˜¶æ®µ 2ï¼šå°ç‰ˆæœ¬æ›´æ–°

#### æ›´æ–°å‘½ä»¤

```bash
# æ›´æ–° browserslist æ•°æ®åº“
npx update-browserslist-db@latest

# æ£€æŸ¥è¿‡æœŸçš„åŒ…
pnpm outdated

# æ›´æ–°æ‰€æœ‰è¡¥ä¸ç‰ˆæœ¬
pnpm update

# æ›´æ–°ç‰¹å®šåŒ…åˆ°æœ€æ–°æ¬¡è¦ç‰ˆæœ¬
pnpm update @headlessui/react @heroicons/react

# æ›´æ–° sharpï¼ˆå¦‚æœéœ€è¦ï¼‰
pnpm update sharp
```

### é˜¶æ®µ 3ï¼šæœªæ¥å‡çº§ï¼ˆ2-3ä¸ªæœˆåï¼‰

å½“ä»¥ä¸‹æ¡ä»¶æ»¡è¶³æ—¶è€ƒè™‘å‡çº§åˆ° Next.js 15ï¼š

1. âœ… `next-intl` å®˜æ–¹æ”¯æŒ Next.js 15
2. âœ… `@headlessui/react` æ”¯æŒ React 19
3. âœ… Next.js 15 å‘å¸ƒç¨³å®šç‰ˆæœ¬ï¼ˆ15.1.0+ï¼‰
4. âœ… ç¤¾åŒºåé¦ˆè‰¯å¥½

## ğŸ”§ ç«‹å³æ‰§è¡Œçš„æ›´æ–°

### 1. æ›´æ–° package.json

```bash
# ä½¿ç”¨ pnpm æ›´æ–°æ‰€æœ‰åŒ…åˆ°æœ€æ–°çš„å…¼å®¹ç‰ˆæœ¬
pnpm update --latest
```

### 2. æ›´æ–°ç‰¹å®šçš„å¼€å‘ä¾èµ–

```bash
# æ›´æ–° sharp åˆ°æœ€æ–°ç‰ˆæœ¬ï¼ˆå›¾ç‰‡ä¼˜åŒ–ï¼‰
pnpm update sharp@latest

# æ›´æ–° TypeScript ç±»å‹å®šä¹‰
pnpm update @types/node @types/react @types/react-dom --latest
```

### 3. æ¸…ç†å’Œé‡å»º

```bash
# æ¸…ç†ç¼“å­˜
rm -rf .next node_modules

# é‡æ–°å®‰è£…
pnpm install

# é‡å»º
pnpm build
```

## âš¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ä½¿ç”¨ Turbopackï¼ˆå®éªŒæ€§ï¼‰

åœ¨ Next.js 14 ä¸­å¯ä»¥å¯ç”¨ Turbopack å¼€å‘æ¨¡å¼ï¼š

```json
// package.json
{
  "scripts": {
    "dev": "next dev --turbo",  // æ·»åŠ  --turbo
    "build": "next build",
    "start": "next start"
  }
}
```

### 2. ä¼˜åŒ–ä¾èµ–

ç§»é™¤æœªä½¿ç”¨çš„åŒ…ï¼š

```bash
# æ£€æŸ¥æœªä½¿ç”¨çš„ä¾èµ–
pnpm exec depcheck
```

## ğŸ› è§£å†³ Deprecation è­¦å‘Š

### punycode è­¦å‘Š

è­¦å‘Šä¿¡æ¯ï¼š
```
DeprecationWarning: The `punycode` module is deprecated
```

**åŸå› **ï¼šæŸäº›ä¾èµ–åŒ…ä½¿ç”¨äº†å·²å¼ƒç”¨çš„ Node.js å†…ç½® `punycode` æ¨¡å—ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **ç­‰å¾…ä¾èµ–æ›´æ–°**ï¼ˆæ¨èï¼‰ï¼šè¿™æ˜¯ä¾èµ–åŒ…çš„é—®é¢˜ï¼Œä¸æ˜¯ä½ çš„ä»£ç 
2. **å¿½ç•¥è­¦å‘Š**ï¼šä¸å½±å“åŠŸèƒ½ï¼Œç­‰å¾… Next.js 15 å’Œä¾èµ–åŒ…æ›´æ–°
3. **ä¸´æ—¶æŠ‘åˆ¶**ï¼ˆå¼€å‘æ—¶ï¼‰ï¼š
   ```bash
   NODE_NO_WARNINGS=1 pnpm dev
   ```

### browserslist è­¦å‘Š

**å·²è§£å†³** âœ…ï¼šè¿è¡Œäº† `npx update-browserslist-db@latest`

## ğŸ“‹ æ›´æ–°æ£€æŸ¥æ¸…å•

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¹¶è®°å½•ç»“æœï¼š

```bash
# 1. æ£€æŸ¥è¿‡æœŸçš„åŒ…
pnpm outdated

# 2. æ£€æŸ¥å®‰å…¨æ¼æ´
pnpm audit

# 3. æ£€æŸ¥ Next.js æœ€æ–°ç‰ˆæœ¬
pnpm info next versions

# 4. æ£€æŸ¥ next-intl å…¼å®¹æ€§
pnpm info next-intl peerDependencies
```

## ğŸ¯ æ¨èçš„æ›´æ–°è®¡åˆ’

### æœ¬å‘¨ï¼ˆç°åœ¨ï¼‰

- [x] æ›´æ–° browserslist æ•°æ®åº“
- [ ] è¿è¡Œ `pnpm update` æ›´æ–°è¡¥ä¸ç‰ˆæœ¬
- [ ] æµ‹è¯•åº”ç”¨åŠŸèƒ½
- [ ] æäº¤ä»£ç 

### ä¸‹ä¸ªæœˆ

- [ ] æ£€æŸ¥ `next-intl` æ˜¯å¦æ”¯æŒ Next.js 15
- [ ] æŸ¥çœ‹ Next.js 15 çš„å˜æ›´æ—¥å¿—
- [ ] åœ¨å¼€å‘åˆ†æ”¯æµ‹è¯• Next.js 15

### 2-3ä¸ªæœˆå

- [ ] è¯„ä¼° Next.js 15 çš„ç¨³å®šæ€§
- [ ] è§„åˆ’å®Œæ•´çš„å‡çº§è®¡åˆ’
- [ ] æ‰§è¡Œå‡çº§å¹¶å…¨é¢æµ‹è¯•

## ğŸ” ç›‘æ§èµ„æº

å…³æ³¨è¿™äº›èµ„æºäº†è§£å‡çº§æ—¶æœºï¼š

- [Next.js å‘å¸ƒè¯´æ˜](https://github.com/vercel/next.js/releases)
- [next-intl æ›´æ–°æ—¥å¿—](https://github.com/amannn/next-intl/releases)
- [React 19 å‘å¸ƒçŠ¶æ€](https://react.dev/blog)

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å§‹ç»ˆåœ¨æ–°åˆ†æ”¯æµ‹è¯•å‡çº§**
2. **å‡çº§å‰å¤‡ä»½æˆ–æäº¤ä»£ç **
3. **é˜…è¯»å‡çº§æŒ‡å—å’Œå˜æ›´æ—¥å¿—**
4. **é€æ­¥å‡çº§ï¼Œä¸è¦è·³ç‰ˆæœ¬**
5. **å…ˆåœ¨å¼€å‘ç¯å¢ƒæµ‹è¯•ï¼Œå†éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ**

## ğŸš¨ ç´§æ€¥ä¿®å¤

å¦‚æœé‡åˆ°å®‰å…¨æ¼æ´ï¼š

```bash
# æŸ¥çœ‹å®‰å…¨é—®é¢˜
pnpm audit

# è‡ªåŠ¨ä¿®å¤ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
pnpm audit fix

# åªä¿®å¤ç”Ÿäº§ä¾èµ–
pnpm audit fix --prod
```

## ğŸ“ è·å–å¸®åŠ©

- [Next.js Discord](https://nextjs.org/discord)
- [next-intl GitHub Issues](https://github.com/amannn/next-intl/issues)
- [Stack Overflow](https://stackoverflow.com/questions/tagged/next.js)

---

**å»ºè®®**ï¼šä¿æŒå½“å‰çš„ Next.js 14 é…ç½®ï¼Œå®šæœŸè¿è¡Œ `pnpm update` æ›´æ–°è¡¥ä¸ç‰ˆæœ¬ï¼Œç­‰å¾… 2-3 ä¸ªæœˆåå†è€ƒè™‘å‡çº§åˆ° Next.js 15ã€‚

**å½“å‰çŠ¶æ€**ï¼šâœ… ç”Ÿäº§å°±ç»ªï¼Œç¨³å®šå¯é 
